#### 简介

Feed流是一种呈现内容给用户并持续更新的方式，用户可以选择订阅多个资源，订阅源不再是某个内容，而是生产内容的人/团体，是一个专门为消费者提供信息的生产者。例如：微信的朋友圈、今日头条的推荐页、知乎的关注页、手机背景主题更新等

#### 主要模式

- 推（Push）
- 拉（Pull）
- 推拉结合（Hybrid）

> 推模式

后台一键发送手机短信提示活动开始，这类场景要求延时不能太久，通常操作后后台会记录到群发表中，并写入队列，然后在队列中分批给对应的用户发送短信。对于用户量大的情况下会大量消耗服务器资源，但对于延时要求高的场景比较适合

> 拉模式

微博用户关注了很多博主，当需要拉取最新动态时，首先会去查询关注了哪些博主，然后再检索这些博主新发的内容。这种场景需要用户主动触发，例如：重新进入APP或手动刷新，虽然不能实时通知所有的用户，但可以有效地减小服务器的资源，按需分批

> 推拉结合模式

按用户在线状态分配不同的方式，主动推送给在线用户，离线用户上线之后被动拉取


使用哪种模式，取决于需求要求是否必须实时，推送量是否大而导致系统压力异常

#### 举例

> 消息群发流程

1. 在缓存中记录群发消息的最新id(max_msg_id)

2. 在缓存中记录某用户最新同步的群发消息的id(user_max_msg_id)

3. 查询群发消息表中 id 在 max_msg_id 与 user_max_msg_id 之间的群发消息记录

4. 同步写入单发消息中，并同时更新 user_max_msg_id




#### 简介

秒杀页上有一个倒计时的按钮，一旦这个倒计时的时间到了，按钮就被点亮，让用户可以点击按钮下单。一般来说下单时需要填写一个校验码，以防止是机器来抢

#### 流程

- 前端页面要不断地向后端来请求活动是否开始，一般每秒请求一次

- 每次询问的时候，后端都会给前端一个时间，以校准前端的时间

- 一旦后端服务器表示活动可以开始，后端服务会返回一个 URL

- 这个 URL 会被安置在那个按钮上，就可以点击了。点击后，如果抢到了库存，就进入支付页面，如果没有则返回秒杀已结束

#### 解决方案

- 将请求尽量拦截在系统上游

1. 活动未开始不给点击，禁止用户多次提交请求，以免导致多次请求后端

2. 隐藏真实的 URL 或 Token ，等活动开始后再返回给前端

3. 需要填写验证码

- 结合缓存系统

1. 对用户操作进行限流

2. 放到队列进行处理，处理过程前端显示正在抽奖中，队列中可以过滤部分用户，防止直接读取数据库

3. 利用前端统计在抢总人数，后端根据在线总人数按比例放到队列，再从队列中过滤

- 对业务规则进行优化，把活动分成多个时间段进行
